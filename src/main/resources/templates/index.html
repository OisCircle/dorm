<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>登陆</title>

    <link rel="stylesheet" href="/webjars/font-awesome/4.7.0/css/font-awesome.min.css">
    <link rel="stylesheet" href="/webjars/bootstrap/4.0.0/css/bootstrap.css">
    <link rel="stylesheet" href="asserts/css/login.css">

</head>
<body>
<div class="container-fluid" style="width:100%; height:100%; top:0; left:0; position:absolute; background:#D1FFFD;">
    <form class="form-horizontal">
        <span class="heading">宿舍管理系统登陆</span>
        <div class="form-group">
            <input type="text" id="loginId" class="form-control" placeholder="学号/工号">
            <i class="fa fa-user"></i>
        </div>
        <div class="form-group help">
            <input type="password" id="loginPassword" class="form-control" placeholder="密码">
            <i class="fa fa-lock"></i>
            <a href="#" class="fa fa-question-circle"></a>
        </div>
        <div class="form-group">
            <button id="studentRegister" type="button" class="btn btn-default">学生注册</button>
            <div class="main-checkbox">
                <input type="checkbox" value="0" id="rememberMe" name="rememberMe"/>
                <label for="rememberMe"></label>
            </div>
            <label for="rememberMe"><span class="text">记住我</span></label>
            <br>
            <button id="dormOfficerRegister" type="button" class="btn btn-default">宿管注册</button>
            <div class="main-checkbox">
                <input type="checkbox" value="0" id="isDormOfficer" name="isDormOfficer"/>
                <label for="isDormOfficer"></label>
            </div>
            <label for="isDormOfficer"><span class="text">我是宿管</span></label>
            <br>
            <button id="gotoLogin" type="button" class="btn btn-default">登录</button>

        </div>
        <p id="warningText" style="position:absolute; left:50%; transform:translateX(-50%); text-align:center;"></p>
    </form>
</div>


<script src="/webjars/jquery/3.3.1-1/jquery.js"></script>
<script>
    $('#gotoLogin').click(function () {
        // console.log($('#loginId').val()  + " - " + $('#loginPassword').val())
        let isRemMe = 0;
        if ($('#rememberMe').is(':checked')) {
            isRemMe = 1
        }
        let isDormOfficer = 'dormOfficer';
        if (!$('#isDormOfficer').is(':checked')) {
            isDormOfficer = 'student'
        }
        $.ajax({
            type: 'POST',
            url: '/' + isDormOfficer + '/login',
            dataType: 'json',

            data: {
                'id': $('#loginId').val(),
                'password': $('#loginPassword').val(),
                'rememberMe': isRemMe
            },
            success: function (result) {
                if (result.code == 200 && isDormOfficer == 'dormOfficer') {
                    //跳转主页
                    window.location.href = "/dormOfficerIndex" + "?id=" + $('#loginId').val()
                } else if (result.code == 200 && isDormOfficer == 'student') {
                    //跳转主页
                    window.location.href = "/studentIndex" + "?id=" + $('#loginId').val()
                } else {
                    $('#warningText').text(result.message);
                }
            },
            error: function () {

            }
        });
    });
    $('#studentRegister').click(function () {
            window.location.href = "/studentRegister";
        }
    );
    $('#dormOfficerRegister').click(function () {
        window.location.href = "/dormOfficerRegister";
    })

</script>

</body>
</html>